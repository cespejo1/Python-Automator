#OM Interface Automation Tool v1.0 by Carlos Espejo and James Barett 6.9.2016
import ctypes
import os
import openpyxl

print("OM Interface Automation Tool v1.0 by Carlos Espejo and James Barett\n")

validOption = False

EnumWindows = ctypes.windll.user32.EnumWindows
EnumWindowsProc = ctypes.WINFUNCTYPE(ctypes.c_bool, ctypes.POINTER(ctypes.c_int), ctypes.POINTER(ctypes.c_int))
GetWindowText = ctypes.windll.user32.GetWindowTextW
GetWindowTextLength = ctypes.windll.user32.GetWindowTextLengthW
IsWindowVisible = ctypes.windll.user32.IsWindowVisible
 
titles = []
def foreach_window(hwnd, lParam):
	if IsWindowVisible(hwnd):
		length = GetWindowTextLength(hwnd)
		buff = ctypes.create_unicode_buffer(length + 1)
		GetWindowText(hwnd, buff, length + 1)
		titles.append(buff.value)
	return True
	
	wb=openpyxl.load_workbook('Book1.xlsx')
	sheet=wb.get_sheet_by_name('Sheet1')
	return sheet['A1'].value

while validOption == False:
        choice = input("Hello! Please tell us what to do >>> ")

        print("Your choice was %s"%choice)

        if choice == "C":
                print("Calibrate")
                validOption = True
        
        elif choice == "I":
                print("Import")
                validOption = True
                wb=openpyxl.load_workbook('Book1.xlsx')
                sheet=wb.get_sheet_by_name('Sheet1')
                print(sheet['B1'].value)
        
        
        elif choice == "P":
                print("Paste")
                validOption = True
        
        elif choice == "Q":
                validOption = True
                exit()
        
        elif choice == "W":
                validOption = True
                EnumWindows(EnumWindowsProc(foreach_window), 0)
                print(titles)
                exit()
        
        else:
                print("Available options are:")
                print("C - Calibrate")
                print("I - Import")
                print("P - Paste")
                print("Q - Quit")
                print("W - Windows")
                validOption = False

#Calibrate
#Open/Read/Import
#Send/Paste/Output
#Select Window
#Handle Oracle Errors
